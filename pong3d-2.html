<!DOCTYPE html>
<html>

<scrip>
  <meta charset="utf-8">
  <title>PONG</title>
  <meta name="description" content="PONG">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-animation-component@^4.1.2/dist/aframe-animation-component.min.js"></script>
  <script
    src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.1.2/dist/aframe-physics-system.min.js"></script>
  <script src="https://unpkg.com/aframe-physics-extras@0.1.2/dist/aframe-physics-extras.min.js"></script>

  <body>
    <script type="text/javascript">
      var p1 = document.getElementById("scoreP1");
      var p2 = document.getElementById("scoreP2");
      var pontosP1 = 0;
      var pontosP2 = 0;
      function atualizaPontos() {
        p1.setAttribute("value", scoreVal);
        p2.setAttribute("value", scoreVal);
      }
      function atualizaTela(){
        //atualizar a tela
      }
      AFRAME.registerComponent('mover-players', {
        schema: { speed: { default: 1 } },
        init: function () {
          this.ifMouseDown = false;
          this.x_cord = 0;
          this.y_cord = 0;

          const el = this.el;
          const player = document.getElementById('player');
          const playerPos = el.getAttribute('position');
          console.log("y " + playerPos.y);




          document.addEventListener('mousedown', this.OnDocumentMouseDown.bind(this));
          document.addEventListener('mouseup', this.OnDocumentMouseUp.bind(this));
          document.addEventListener('mousemove', this.OnDocumentMouseMove.bind(this));
        },
        OnDocumentMouseDown: function (event) {
          this.ifMouseDown = true;
          this.x_cord = event.clientX;
          this.y_cord = event.clientY;

        },
        OnDocumentMouseUp: function () {
          this.ifMouseDown = false;
        },
        OnDocumentMouseMove: function (event) {
          if (this.ifMouseDown) {
            var temp_x = event.clientX - this.x_cord;
            var temp_y = event.clientY - this.y_cord;
            this.el.object3D.translateZ(-temp_y * this.data.speed / 20);
            this.el.object3D.translateX(temp_x * this.data.speed / 100);
            this.y_cord = event.clientY;
            this.x_cord = event.clientX;
            const el = this.el;
            const player = document.getElementById('player');
            const playerPos = el.getAttribute('position');
            if (playerPos.y > 54) {
              playerPos.y = "52";
            }
            if (playerPos.y < -45) {
              playerPos.y = "-45";
            }
            if (playerPos.x < -112.4) {
              playerPos.x = "-110.4";
            }
            if (playerPos.x > 0) {
              playerPos.x = "0";
            }



          }
        }

      });



    </script>


    <a-scene physics="debug: false;gravity: 0;friction: 0; restitution: 1.0;" antialias="true">
      <a-text value="Player 1: " width="100" id="p1" color="black" position="-80 52 0" rotation="0 0 0"></a-text>
      <a-text value="0" width="100" bold=true id="scoreP1" color="white" position="-62 52 0" rotation="0 0 0">
      </a-text>
      <a-text value="Player 2: " width="100" id="p2" color="black" position="40 52 0" rotation="0 0 0"></a-text>
      <a-text value="0" width="100" id="scoreP2" color="white" position="60 52 0" rotation="0 0 0"></a-text>
      <!-- <a-box id="linha" width="0.1" height="38 " depth="0.1" position="0  5 -27" rotation="-90 0 0" color="#FFFFFF">
    </a-box>-->
      <a-plane src="img.jpg" position="0 4 -30" rotation="0 0 0" width="240 " height="120  " color="black">
      </a-plane>

      <a-box static body physics-collider="ignoreSleep: true" id="ladoe" scale="0.1  8 243" position="0.4 65 -28"
        rotation="0 90 90" color="black">
      </a-box>
      <a-box static body physics-collider="ignoreSleep: true" id="ladod" scale="0.1  8 243" position="0.4 -57 -28"
        rotation="0 90 90" color="black">
      </a-box>


      <a-box static body physics-collider="ignoreSleep: true" id="trase" scale="0.1  8 125" position="-120 4 -30"
        rotation="90 0 0" color="black">
      </a-box>
      <a-box static body physics-collider="ignoreSleep: true" id="trasd" scale="0.1  8 125" position="120  4 -30"
        rotation="90 0 0" color="black">
      </a-box>


      <a-box static-body physics-collider="ignoreSleep: true" id="player" scale="3 10 25" position="-104  0 -20"
        rotation="-90 0 0" color="#4CC3D9" mover-players>
      </a-box>
      <a-box static-body physics-collider="ignoreSleep: true" id="enemy" scale="3  10 25" position="104 5 -20"
        rotation="-90 0 0" color="#FF0000">
      </a-box>
      <!-- look-controls wasd-controls mexer paletas com  wasd-->
      <!--  mover-players mecher com mouse no eixo x-->
      </a-box>
      <a-sphere static body  id="ball" position="0 4 -30" radius="2.8" color="#DCDCDC"></a-sphere>
      </a-sphere>

      <a-entity position="-0 -10 80">
        <a-camera user-height="-20.0" look-controls="enabled:false">
        </a-camera>
      </a-entity>


      <a-assets>
        <!--
      <a-asset-item id="crate-obj" src="models/aztec-temple.obj"></a-asset-item>
      <a-asset-item id="crate-mtl" src="models/aztec-temple.mtl"></a-asset-item>
      -->
      </a-assets>
      <!--<a-obj-model src="#crate-obj" mtl="#crate-mtl  "></a-obj-model> -->
      <a-sky id="sky" color="#00ced1"></a-sky>

    </a-scene>


  </body>

</html>