<html>

<head>
    <title>Aframe-Pong</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-animation-component@^4.1.2/dist/aframe-animation-component.min.js"></script>
    <script
        src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.1.2/dist/aframe-physics-system.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-extras@0.1.2/dist/aframe-physics-extras.min.js"></script>
    <script>
        if (typeof AFRAME === 'undefined') {
            throw new Error('Component attempted to register before AFRAME was available.')
        }

        /* here you write your components. */
        AFRAME.registerComponent('player-mover', {
            schema: {},
            multiple: false,
            init: function () {
                const el = this.el
                const player = document.getElementById('play')
                const playerPos = el.getAttribute('position')

                el.addEventListener('raycaster-intersected', (e) => {
                    const intersectedPos = e.detail.intersection.point
                    const newPos = new THREE.Vector3(
                        intersectedPos.x,
                        intersectedPos.y,
                        playerPos.z
                    )
                    player.setAttribute('position', newPos)
                })
            }
        })

    </script>
</head>

<body>
    <a-scene physics="debug: false;gravity: 0;friction: 0; restitution: 1.0;" antialias="true">
        <a-assets>

            <a-mixin src="mesa.jpg" id="mesa" geometry="primitive:box" scale="120 240 5" material="color:lightblue"
                rotation="0 0 0" static-body>
            </a-mixin>
            <a-mixin id="racket" geometry="primitive:box" material="color: blue; opacity:0.8" scale="4.9  8 18.6"
                rotation="0 90 0" static-body player-mover></a-mixin >
        </a-assets>


        <a-entity mixin="mesa" position="0 -30 -90" rotation="90 0 0" color="#00800">
        </a-entity>

        <a-entity id="lcd" bmfont-text="text: 0 - 0;align:center;" position="-2.5 1 -2"></a-entity>

        <a-sphere id="ball" radius="2.25" material="color: lightgreen" ball position="5 -20 -90" dynamic-body>
        </a-sphere>

        <a-entity id="adversario" position="0 -10  -90" mixin="racket" material="color:red;opacity:1;"></a-entity>


        <a-box id="player" player position="0 -20 30" mixin="racket"></a-box>
        <a-camera position="0 -0.5 1" raycaster></a-camera>

        <a-plane player-mover material="opacity:0; color:blue" position="0 1.0 0" scale="1.3 1.3 0.1"></a-plane>

        <a-sky color="#ccc"></a-sky>

        <a-entity position="0 10 100 ">
            <a-camera user-height="10.0" look-controls="enabled:false">
            </a-camera>
        </a-entity>


        <a-assets>
    </a-scene>
</body>

</html>